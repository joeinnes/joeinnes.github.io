<!DOCTYPE html>
<html lang="en">
<title>Joe Innes | Portfolio</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://unpkg.com/tachyons/css/tachyons.min.css">

<body>
  <section class="cf pa3 mw9 center">
    <header class="fn fl-ns w-50-ns pr4-ns">
      <nav class="mb1 mt0 bt bw2">
        <a href="index.html" class="link black fw9 dib mr3 f1 f-headline-ns">Joe Innes</a><br/>
        <a href="index.html" class="link black-50 f4 f3-ns dib mr3">Home</a>
        <a href="portfolio.html" class="link black-50 f4 f3-ns dib mr3 underline">Portfolio</a>
      </nav>
    </header>

    <article class="h-100 dt w-100 pv7" id="loading">
      <div class="dtc v-mid tc ph3 ph4-l">
        <div class="sk-folding-cube">
          <div class="sk-cube1 sk-cube"></div>
          <div class="sk-cube2 sk-cube"></div>
          <div class="sk-cube4 sk-cube"></div>
          <div class="sk-cube3 sk-cube"></div>
        </div>
      </div>
    </article>

    <section class="fl w-100" id="portfolio"></section>
  </section>
  <script src="https://unpkg.com/es6-promise"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/6.18.1/babel.min.js"></script>
  <script src="https://unpkg.com/fetch-polyfill"></script>
  <script type="text/babel">
    const baseUrl = 'https://joeinn.es/'
    const user = 'joeinnes'
    window.fetch('projects.json')
    .then((data) => data.json())
    .then((data) => {
      Promise.all(data.map((item) => {
        return new Promise((resolve, reject) => {
          window.fetch('https://joeinn.es/' + item + '/project.json')
            .then((data) => {
              if (data.status === 200) {
                return data.json()
              } else {
                return null
              }
            })
            .then((data) => {
            if (data) {
              let newStory = createCard(data, baseUrl + item)
              resolve(newStory)
            } else {
              resolve()
            }
            })
            .catch((err) => {
              console.error(err)
              resolve()
            })
        })
      }))
      .then((data) => {
        let projects = data.filter((item) => item !== undefined)
        projects.forEach((item) => {
          document.getElementById('portfolio').appendChild(item)
        })
        document.getElementById('loading').style.display = 'none'
      })
      .catch((err) => {
        console.error('Something went terribly wrong: ' + err)
      })
    })
    .catch((err) => {
        console.error('Something went terribly wrong: ' + err)
      })
          
    function createCard (data, url) {
      let card = document.createElement('div')
      card.classList.add('fl', 'w-100', 'w-50-ns')

      let article = document.createElement('article')
      article.classList.add('pa1', 'pa3-ns', 'f5', 'f4-ns')

      let title = document.createElement('h2')
      title.classList.add('f2')
      title.innerText = data.title

      let link = document.createElement('a')
      link.classList.add('link')
      link.href = url

      let img = document.createElement('img')
      img.classList.add('w-100', 'f5', 'f4-ns', 'measure', 'grow')
      img.src = url + '/' + data.image
      img.alt = 'Screenshot of ' + data.title

      link.appendChild(img)

      let summary = document.createElement('p')
      summary.classList.add('measure', 'lh-copy')
      summary.innerText = data.summary

      let techSection = document.createElement('section')
      let techSectionHeader = document.createElement('h3')
      techSectionHeader.innerText = 'Built using:'

      let techList = document.createElement('ul')
      techList.classList.add('list', 'pl0')
      let techStack = data.technologies_used.sort((a, b) => a > b)
      techStack.forEach((tech) => {
        let thisTech = document.createElement('li')
        thisTech.innerHTML = tech
        techList.appendChild(thisTech)
      })

      techSection.appendChild(techSectionHeader)
      techSection.appendChild(techList)

      let creditSection = document.createElement('section')
      let creditSectionHeader = document.createElement('h3')
      creditSectionHeader.innerText = 'With thanks to'
      let creditsList = document.createElement('section')
      let creds = data.credits.sort((a, b) => a.name > b.name)
      creds.forEach((credit) => {
        let link = document.createElement('a')
        link.classList.add('link', 'b', 'no-underline', 'black', 'dib', 'pr3', 'hover-' + randomColour())
        link.href = credit.link
        link.innerText = credit.name
        creditsList.appendChild(link)
      })

      creditSection.appendChild(creditSectionHeader)
      creditSection.appendChild(creditsList)

      article.appendChild(title)
      article.appendChild(link)
      article.appendChild(summary)
      article.appendChild(techSection)
      article.appendChild(creditSection)
      card.appendChild(article)

      return card
    }

    function randomColour () {
      let colours = [
        'dark-red',
        'red',
        'orange',
        'gold',
        'yellow',
        'purple',
        'light-purple',
        'hot-pink',
        'dark-pink',
        'pink',
        'dark-green',
        'green',
        'navy',
        'dark-blue',
        'blue',
        'light-blue'
      ]
      return colours[Math.floor(Math.random() * colours.length)]
    }
  </script>
  <style>
    .sk-folding-cube {
      margin: 20px auto;
      width: 40px;
      height: 40px;
      position: relative;
      -webkit-transform: rotateZ(45deg);
      transform: rotateZ(45deg);
    }
    
    .sk-folding-cube .sk-cube {
      float: left;
      width: 50%;
      height: 50%;
      position: relative;
      -webkit-transform: scale(1.1);
      -ms-transform: scale(1.1);
      transform: scale(1.1);
    }
    
    .sk-folding-cube .sk-cube:before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: #333;
      -webkit-animation: sk-foldCubeAngle 2.4s infinite linear both;
      animation: sk-foldCubeAngle 2.4s infinite linear both;
      -webkit-transform-origin: 100% 100%;
      -ms-transform-origin: 100% 100%;
      transform-origin: 100% 100%;
    }
    
    .sk-folding-cube .sk-cube2 {
      -webkit-transform: scale(1.1) rotateZ(90deg);
      transform: scale(1.1) rotateZ(90deg);
    }
    
    .sk-folding-cube .sk-cube3 {
      -webkit-transform: scale(1.1) rotateZ(180deg);
      transform: scale(1.1) rotateZ(180deg);
    }
    
    .sk-folding-cube .sk-cube4 {
      -webkit-transform: scale(1.1) rotateZ(270deg);
      transform: scale(1.1) rotateZ(270deg);
    }
    
    .sk-folding-cube .sk-cube2:before {
      -webkit-animation-delay: 0.3s;
      animation-delay: 0.3s;
    }
    
    .sk-folding-cube .sk-cube3:before {
      -webkit-animation-delay: 0.6s;
      animation-delay: 0.6s;
    }
    
    .sk-folding-cube .sk-cube4:before {
      -webkit-animation-delay: 0.9s;
      animation-delay: 0.9s;
    }
    
    @-webkit-keyframes sk-foldCubeAngle {
      0%,
      10% {
        -webkit-transform: perspective(140px) rotateX(-180deg);
        transform: perspective(140px) rotateX(-180deg);
        opacity: 0;
      }
      25%,
      75% {
        -webkit-transform: perspective(140px) rotateX(0deg);
        transform: perspective(140px) rotateX(0deg);
        opacity: 1;
      }
      90%,
      100% {
        -webkit-transform: perspective(140px) rotateY(180deg);
        transform: perspective(140px) rotateY(180deg);
        opacity: 0;
      }
    }
    
    @keyframes sk-foldCubeAngle {
      0%,
      10% {
        -webkit-transform: perspective(140px) rotateX(-180deg);
        transform: perspective(140px) rotateX(-180deg);
        opacity: 0;
      }
      25%,
      75% {
        -webkit-transform: perspective(140px) rotateX(0deg);
        transform: perspective(140px) rotateX(0deg);
        opacity: 1;
      }
      90%,
      100% {
        -webkit-transform: perspective(140px) rotateY(180deg);
        transform: perspective(140px) rotateY(180deg);
        opacity: 0;
      }
    }
  </style>
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-63929221-2', 'auto');
      ga('send', 'pageview');
    </script>
</body>

</html>

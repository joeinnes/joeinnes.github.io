<!DOCTYPE html>
<html lang="en">
<title>Joe Innes | Portfolio</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://unpkg.com/tachyons/css/tachyons.min.css">

<body>
  <article class="vh-100 dt w-100" id="loading">
    <div class="dtc v-mid tc ph3 ph4-l">
      <div class="sk-folding-cube">
        <div class="sk-cube1 sk-cube"></div>
        <div class="sk-cube2 sk-cube"></div>
        <div class="sk-cube4 sk-cube"></div>
        <div class="sk-cube3 sk-cube"></div>
      </div>
    </div>
  </article>
  <section class="cf pa3 mw9 center">
    <header class="fn fl-ns w-50-ns pr4-ns">
    <header class="fn fl-ns pr4-ns">
      <nav class="mb1 mt0 bt bw2">
        <a href="index.html" class="link black fw9 dib mr3 f1 f-headline-ns">Joe Innes</a><br/>
        <a href="index.html" class="link black-50 f4 f3-ns dib mr3">Home</a>
        <a href="portfolio.html" class="link black-50 f4 f3-ns dib mr3 underline">Portfolio</a>
      </nav>
    </header>
    </header>
    <section class="fl w-100" id="portfolio">
    </section>
    <script>
const baseUrl = 'https://joeinn.es/'
const portfolio = ['bubi-bikes', 'weather-display']
Promise.all(portfolio.map((item) => {
  return new Promise((resolve, reject) => {
    window.fetch(baseUrl + item + '/project.json')
      .then((data) => data.json())
      .then((data) => {
       let newStory = createCard(data, baseUrl + item)
        document.getElementById('portfolio').appendChild(newStory)
        resolve()
      })
      .catch((err) => {
        console.error(err)
      })
  })
})
.then(() => {
  document.getElementById('loading').style.display = 'none'
})

function createCard (data, url) {
  let card = document.createElement('div')
  card.classList.add('fl', 'w-100', 'w-50-ns')

  let article = document.createElement('article')
  article.classList.add('pa1', 'pa3-ns', 'f5', 'f4-ns')

  let title = document.createElement('h2')
  title.classList.add('f2')
  title.innerText = data.title

  let link = document.createElement('a')
  link.classList.add('link')
  link.href = url

  let img = document.createElement('img')
  img.classList.add('w-100', 'f5', 'f4-ns', 'measure', 'grow')
  img.src = url + '/' + data.image
  img.alt = 'Screenshot of ' + data.title

  link.appendChild(img)

  let summary = document.createElement('p')
  summary.classList.add('measure', 'lh-copy')
  summary.innerText = data.summary

  let techSection = document.createElement('section')
  let techSectionHeader = document.createElement('h3')
  techSectionHeader.innerText = 'Built using:'

  let techList = document.createElement('ul')
  techList.classList.add('list', 'pl0')
  data.technologies_used.forEach((tech) => {
    let thisTech = document.createElement('li')
    thisTech.innerHTML = tech
    techList.appendChild(thisTech)
  })

  techSection.appendChild(techSectionHeader)
  techSection.appendChild(techList)

  let creditSection = document.createElement('section')
  let creditSectionHeader = document.createElement('h3')
  creditSectionHeader.innerText = 'With thanks to'
  let creditsList = document.createElement('section')
  data.credits.forEach((credit) => {
    let link = document.createElement('a')
    link.classList.add('link', 'b', 'no-underline', 'black', 'dib', 'pr3', 'hover-' + randomColour())
    link.href = credit.link
    link.innerText = credit.name
    creditsList.append(link)
  })

  creditSection.appendChild(creditSectionHeader)
  creditSection.appendChild(creditsList)

  article.appendChild(title)
  article.appendChild(link)
  article.appendChild(summary)
  article.appendChild(techSection)
  article.appendChild(creditSection)
  card.appendChild(article)

  return card
}

function randomColour () {
  let colours = [
    'dark-red',
    'red',
    'orange',
    'gold',
    'yellow',
    'purple',
    'light-purple',
    'hot-pink',
    'dark-pink',
    'pink',
    'dark-green',
    'green',
    'navy',
    'dark-blue',
    'blue',
    'light-blue'
  ]
  return colours[Math.floor(Math.random() * colours.length)]
}

</script>
</body>

</html>
